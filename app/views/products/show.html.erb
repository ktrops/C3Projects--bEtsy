<h2><%= @product.name %></h2>

<% if flash[:errors] %>
  <div>
    <p class="alert alert-danger"><%= flash[:errors] %></p>
  </div>
<% end %>

<% if flash[:success] %>
  <div>
    <p class="alert alert-success"><%= flash[:success] %></p>
  </div>
<% end %>

<%= render partial: 'shared/product_details', locals: { shopping_page: true } %>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Reviews</h3>
  </div>
  <div class="panel-body">
    <!-- refactor this logic '@user && @user == @product.user', make it be elsewhere -->
    <% unless @user && @user == @product.user %>
      <p><%= link_to 'Write a Review', new_product_review_path(@product), class: "btn btn-default" %></p>
    <% end %>
    <%= render partial: 'review', collection: @reviews %>
  </div>
</div>

<p><%= link_to 'See All Products', products_path, class: "btn btn-lg btn-default" %></p>

<% if @user && @user == @product.user %>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Merchant Tools</h3>
    </div>
    <div class="panel-body">
      <p><%= link_to 'Edit Product', edit_product_path(@product), class: "btn btn-default" %></p>

      <!-- <p><%# active_text(@product) %> -->
      <!-- <%# link_to 'Toggle Active', toggle_active_path(@product), method: :put, class: "btn btn-warning" %></p> -->

      <%= render partial: 'active_text_toggle_button' %>
      
      <%= form_for [@product, @product_category], html: { class: "form" } do |f| %>
        <div class="form-group inline-form">
          <%= f.select (:category_id), class: "form-control" do %>
            <% Category.all.each do |category| %>
              <%= content_tag(:option, category.name, value: category.id)%>
            <% end %>
          <% end %>
        </div>

        <%= f.submit "Add Category", class: "btn btn-primary" %>
      <% end %>

      <!-- or a set of checkboxes with the current category(ies) already checked -->
      <%= link_to 'Create a new category', new_category_path, class: "btn btn-default" %>
    </div>
  </div>
<% end %>
